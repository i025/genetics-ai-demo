<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIé—ä¼ ç—…å¾®è¯¾æ¼”ç¤º - å¸¸æŸ“è‰²ä½“éšæ€§é—ä¼ </title>
    <!-- å¼•å…¥EChartså›¾è¡¨åº“ -->
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <!-- å¼•å…¥Coze Web SDK -->
    <script src="https://lf-cdn.coze.cn/obj/unpkg/flow-platform/chat-app-sdk/1.2.0-beta.19/libs/cn/index.js"></script>
    <style>
        /* å…¨å±€æ ·å¼ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: #333;
            line-height: 1.6;
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        
        /* å¤´éƒ¨æ ·å¼ */
        header {
            background: linear-gradient(135deg, #4F46E5 0%, #7E69AB 100%);
            color: white;
            padding: 35px 40px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        header::before {
            content: "ğŸ§¬";
            position: absolute;
            font-size: 120px;
            opacity: 0.1;
            top: 10px;
            right: 40px;
        }
        
        header h1 {
            font-size: 2.8rem;
            margin-bottom: 10px;
            font-weight: 700;
            text-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        
        header p {
            font-size: 1.2rem;
            opacity: 0.9;
            max-width: 800px;
            margin: 0 auto;
        }
        
        /* ä¸»è¦å†…å®¹åŒºåŸŸ */
        .main-content {
            display: flex;
            flex-wrap: wrap;
            min-height: 700px;
        }
        
        /* å·¦ä¾§å¾®è¯¾è®²è§£åŒº */
        .lesson-panel {
            flex: 1;
            min-width: 350px;
            padding: 35px;
            border-right: 1px solid #eaeaea;
            background: #fdfdfd;
        }
        
        .lesson-panel h2 {
            color: #4F46E5;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 3px solid #f0f0f0;
            font-size: 1.8rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .lesson-panel h2::before {
            content: "ğŸ“š";
            font-size: 1.5rem;
        }
        
        /* é—ä¼ å›¾è°±åŒºåŸŸ */
        .chart-panel {
            margin-bottom: 30px;
            padding: 25px;
            background: linear-gradient(135deg, #f8f9ff 0%, #f0f4ff 100%);
            border-radius: 15px;
            border: 2px solid #e6eeff;
            box-shadow: 0 5px 15px rgba(79, 70, 229, 0.05);
        }
        
        .chart-panel h3 {
            color: #4F46E5;
            margin-bottom: 15px;
            font-size: 1.4rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .chart-panel h3::before {
            content: "ğŸ§¬";
        }
        
        #familyTree {
            width: 100%;
            height: 320px;
            margin-top: 15px;
            border-radius: 10px;
            background: white;
            box-shadow: 0 3px 10px rgba(0,0,0,0.05);
        }
        
        .info-box {
            margin-top: 25px;
            padding: 20px;
            background: white;
            border-radius: 12px;
            border-left: 5px solid #4F46E5;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
            transition: all 0.3s ease;
        }
        
        .info-box:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 18px rgba(0,0,0,0.08);
        }
        
        .info-box p {
            margin-bottom: 10px;
            font-size: 1.05rem;
        }
        
        .info-box strong {
            color: #4F46E5;
        }
        
        /* æ¦‚å¿µæ¡†æ ·å¼ */
        .concept-box {
            background: linear-gradient(135deg, #f0f9ff 0%, #e6f7ff 100%);
            padding: 25px;
            border-radius: 15px;
            margin-top: 25px;
            border-left: 5px solid #4F46E5;
            box-shadow: 0 5px 15px rgba(0,0,0,0.03);
            transition: all 0.3s ease;
        }
        
        .concept-box:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.06);
        }
        
        .concept-box h3 {
            color: #2d3748;
            margin-bottom: 15px;
            font-size: 1.4rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .concept-box h3::before {
            content: "â­";
        }
        
        .concept-box ul {
            margin-left: 25px;
            margin-top: 15px;
        }
        
        .concept-box li {
            margin-bottom: 12px;
            padding-left: 5px;
            font-size: 1.05rem;
        }
        
        .genotype-example {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 15px;
        }
        
        .genotype-color {
            width: 20px;
            height: 20px;
            border-radius: 4px;
        }
        
        .healthy { background-color: #10B981; }
        .carrier { background-color: #F59E0B; }
        .affected { background-color: #EF4444; }
        
        /* å³ä¾§AIå¯¹è¯åŒº */
        .ai-panel {
            flex: 1;
            min-width: 350px;
            padding: 35px;
            display: flex;
            flex-direction: column;
            background: #fdfdfd;
        }
        
        .ai-panel h2 {
            color: #10B981;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 3px solid #f0f0f0;
            font-size: 1.8rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .ai-panel h2::before {
            content: "ğŸ¤–";
            font-size: 1.5rem;
        }
        
        /* CozeèŠå¤©å®¹å™¨æ ·å¼ */
        .coze-chat-container {
            flex: 1;
            border-radius: 15px;
            overflow: hidden;
            margin-bottom: 25px;
            background: #f9fafb;
            min-height: 450px;
            max-height: 500px;
            border: 2px solid #e5e7eb;
            position: relative;
        }
        
        #coze-chat-iframe {
            width: 100%;
            height: 100%;
            border: none;
            display: block;
        }
        
        .chat-placeholder {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            padding: 40px;
            text-align: center;
            background: linear-gradient(135deg, #f0f9ff 0%, #e6f7ff 100%);
            color: #555;
        }
        
        .chat-placeholder h3 {
            color: #10B981;
            margin-bottom: 15px;
        }
        
        .chat-placeholder p {
            margin-bottom: 10px;
            font-size: 1.05rem;
        }
        
        .chat-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #10B981;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* æœ¬åœ°äº’åŠ¨ç¤ºä¾‹ï¼ˆä¿ç•™è¶£å‘³æ€§ï¼‰ */
        .local-demo {
            margin-top: 30px;
            padding: 20px;
            background-color: #f8fafc;
            border-radius: 12px;
            border: 1px solid #e2e8f0;
        }
        
        .local-demo h4 {
            color: #4F46E5;
            margin-bottom: 15px;
        }
        
        .local-demo button {
            background-color: #4F46E5;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.2s;
        }
        
        .local-demo button:hover {
            background-color: #4338ca;
        }
        
        .answer {
            margin-top: 10px;
            padding: 10px;
            background: #e0f2fe;
            border-radius: 5px;
        }
        
        /* é¡µè„šæ ·å¼ */
        footer {
            text-align: center;
            padding: 25px;
            color: #666;
            font-size: 0.95rem;
            border-top: 1px solid #eee;
            background: #f9fafb;
        }
        
        footer p {
            margin-bottom: 5px;
        }
        
        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 1100px) {
            .main-content {
                flex-direction: column;
            }
            
            .lesson-panel, .ai-panel {
                border-right: none;
                border-bottom: 1px solid #eaeaea;
            }
        }
        
        @media (max-width: 768px) {
            header h1 {
                font-size: 2.2rem;
            }
            
            header p {
                font-size: 1rem;
            }
            
            .lesson-panel, .ai-panel {
                padding: 25px;
            }
            
            #familyTree {
                height: 280px;
            }
            
            .coze-chat-container {
                min-height: 350px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ§¬ åŸºå› é—ä¼ ç—…AIå¾®è¯¾æ¼”ç¤º</h1>
            <p>æ¢ç´¢å¸¸æŸ“è‰²ä½“éšæ€§é—ä¼ çš„å¥¥ç§˜ | äº¤äº’å¼å›¾è°± + AIå¯¼å¸ˆç­”ç–‘</p>
        </header>

        <div class="main-content">
            <section class="lesson-panel">
                <h2>æ ¸å¿ƒæ¦‚å¿µï¼šå¸¸æŸ“è‰²ä½“éšæ€§é—ä¼ </h2>
                <p style="margin-bottom: 20px; font-size: 1.1rem; color: #555;">æœ¬å¾®è¯¾å°†å¸®åŠ©ä½ ç†è§£ä¸€ç±»é‡è¦çš„é—ä¼ ç—…ä¼ é€’è§„å¾‹ï¼Œç»“åˆäº¤äº’å›¾è°±å’ŒAIå¯¼å¸ˆï¼Œæ·±å…¥å­¦ä¹ é—ä¼ å­¦åŸç†ã€‚</p>
                
                <div class="chart-panel">
                    <h3>é—ä¼ ç³»è°±å›¾æ¨¡æ‹Ÿ</h3>
                    <p>ç‚¹å‡»å›¾ä¸­çš„å®¶åº­æˆå‘˜ï¼ŒæŸ¥çœ‹å…¶é—ä¼ ä¿¡æ¯ï¼š</p>
                    <!-- EChartså›¾è¡¨å®¹å™¨ -->
                    <div id="familyTree"></div>
                    <!-- ä¿¡æ¯æ˜¾ç¤ºåŒºåŸŸ -->
                    <div id="memberInfo" class="info-box">
                        <p><strong>å½“å‰é€‰ä¸­ï¼š</strong> <span id="selectedName">æš‚æ— </span></p>
                        <p><strong>åŸºå› å‹ï¼š</strong> <span id="selectedGenotype">-</span></p>
                        <p><strong>è¯´æ˜ï¼š</strong> <span id="selectedDesc">è¯·ç‚¹å‡»ä¸Šæ–¹å›¾è°±ä¸­çš„æˆå‘˜</span></p>
                    </div>
                </div>

                <div class="concept-box">
                    <h3>æ ¸å¿ƒç‰¹ç‚¹</h3>
                    <ul>
                        <li><strong>åŸºå› ä½ç½®</strong>ï¼šè‡´ç—…åŸºå› ä½äº<strong>å¸¸æŸ“è‰²ä½“</strong>ï¼ˆéæ€§æŸ“è‰²ä½“ï¼‰ä¸Šã€‚</li>
                        <li><strong>å‘ç—…æ¡ä»¶</strong>ï¼šåªæœ‰å½“ä¸ªä½“çš„ä¸€å¯¹ç­‰ä½åŸºå› éƒ½æ˜¯<strong>éšæ€§è‡´ç—…åŸºå› ï¼ˆaaï¼‰</strong>æ—¶æ‰ä¼šæ‚£ç—…ã€‚</li>
                        <li><strong>å…³é”®è§’è‰²</strong>ï¼šæºå¸¦ä¸€ä¸ªéšæ€§è‡´ç—…åŸºå› çš„<strong>æ‚åˆå­ï¼ˆAaï¼‰</strong>ç§°ä¸º<strong>æºå¸¦è€…</strong>ï¼Œä»–ä»¬æœ¬èº«å¥åº·ï¼Œä½†å¯èƒ½å°†è‡´ç—…åŸºå› ä¼ ç»™åä»£ã€‚</li>
                    </ul>
                </div>

                <div class="concept-box">
                    <h3>ç»å…¸é—ä¼ è§„å¾‹</h3>
                    <p>å½“<strong>ä¸¤ä½æºå¸¦è€…ï¼ˆAaï¼‰</strong>ç»“å©šæ—¶ï¼Œåä»£çš„åŸºå› å‹æ¦‚ç‡åˆ†å¸ƒå¦‚ä¸‹ï¼š</p>
                    
                    <div class="genotype-example">
                        <div class="genotype-color healthy"></div>
                        <span><strong>å¥åº· (AA)</strong>ï¼šæ¦‚ç‡ 25%</span>
                    </div>
                    
                    <div class="genotype-example">
                        <div class="genotype-color carrier"></div>
                        <span><strong>å¥åº·æºå¸¦è€… (Aa)</strong>ï¼šæ¦‚ç‡ 50%</span>
                    </div>
                    
                    <div class="genotype-example">
                        <div class="genotype-color affected"></div>
                        <span><strong>æ‚£ç—… (aa)</strong>ï¼šæ¦‚ç‡ 25%</span>
                    </div>
                    
                    <p style="margin-top:20px; font-style:italic; color: #4F46E5;">ğŸ‘‰ è¿™å°±æ˜¯"çˆ¶æ¯å¥åº·ï¼Œå­©å­å´å¯èƒ½æ‚£ç—…"çš„é—ä¼ å­¦åŸç†ã€‚</p>
                </div>

                <div class="concept-box">
                    <h3>å­¦ä¹ ç›®æ ‡</h3>
                    <p>ç†è§£ä¸Šè¿°è§„å¾‹åï¼Œä½ å¯ä»¥å°è¯•å‘å³ä¾§çš„AIå¯¼å¸ˆæé—®ï¼Œä¾‹å¦‚ï¼š</p>
                    <ul>
                        <li>"å¦‚æœæˆ‘æ˜¯æºå¸¦è€…ï¼Œæˆ‘çš„å­©å­ä¸€å®šä¼šæ‚£ç—…å—ï¼Ÿ"</li>
                        <li>"è¿‘äº²ç»“å©šä¸ºä»€ä¹ˆä¼šæé«˜é—ä¼ ç—…é£é™©ï¼Ÿ"</li>
                        <li>"ç™½åŒ–ç—…çš„é—ä¼ æ–¹å¼æ˜¯ä»€ä¹ˆï¼Ÿ"</li>
                    </ul>
                </div>
            </section>

            <section class="ai-panel">
                <h2>ğŸ¤– å¯¹è¯AIå¯¼å¸ˆ</h2>
                <p>æˆ‘æ˜¯ä½ çš„ä¸“å±AIç”Ÿç‰©è€å¸ˆ<strong>"åŸºå› åšå£«"</strong>ï¼Œå¯ä»¥ç›´æ¥ä¸æˆ‘å¯¹è¯å­¦ä¹ é—ä¼ å­¦çŸ¥è¯†ï¼š</p>
                
                <!-- CozeèŠå¤©å®¹å™¨ -->
                <div class="coze-chat-container">
                    <div class="chat-placeholder" id="chatPlaceholder">
                        <div class="chat-spinner"></div>
                        <h3>æ­£åœ¨åŠ è½½AIå¯¼å¸ˆ...</h3>
                        <p>è¯·ç¨å€™ï¼ŒAIå¯¼å¸ˆ"åŸºå› åšå£«"å³å°†ä¸ºæ‚¨æœåŠ¡</p>
                        <p style="font-size: 0.9rem; margin-top: 10px; color: #666;">ä½ å¯ä»¥å’¨è¯¢å…³äºé—ä¼ ç—…ã€åŸºå› å‹ã€é—ä¼ è§„å¾‹ç­‰é—®é¢˜</p>
                    </div>
                    <!-- CozeèŠå¤©ç•Œé¢å°†é€šè¿‡iframeåŠ è½½ -->
                </div>

                <!-- æœ¬åœ°äº’åŠ¨ç¤ºä¾‹ï¼ˆä¿ç•™è¶£å‘³æ€§ï¼‰ -->
                <div class="local-demo">
                    <h4>ğŸ§ª æœ¬åœ°äº’åŠ¨æ€è€ƒé¢˜</h4>
                    <p><strong>é—®é¢˜ï¼š</strong>å¦‚æœçˆ¶æ¯éƒ½æ˜¯æºå¸¦è€… (Aa)ï¼Œä»–ä»¬ç”Ÿä¸‹å¥åº·å­©å­ (AA) çš„æ¦‚ç‡æ˜¯å¤šå°‘ï¼Ÿ</p>
                    <div class="answer-area">
                        <button onclick="showAnswer(this)">ç‚¹å‡»æŸ¥çœ‹ç­”æ¡ˆä¸è§£æ</button>
                        <p class="answer" style="display: none;">
                            <strong>ç­”æ¡ˆï¼š25%</strong><br>
                            <strong>è§£æï¼š</strong>æ ¹æ®å­Ÿå¾·å°”é—ä¼ è§„å¾‹ï¼ŒAa x Aa çš„åä»£åŸºå› å‹æ¯”ä¾‹ä¸ºï¼šAA(25%)ï¼ŒAa(50%)ï¼Œaa(25%)ã€‚å…¶ä¸­ï¼ŒAA åŸºå› å‹è¡¨ç°ä¸ºå¥åº·ä¸”éæºå¸¦è€…ã€‚
                        </p>
                    </div>
                </div>
            </section>
        </div>

        <footer>
            <p>è®¡ç®—æœºè®¾è®¡å¤§èµ› Â· AIå¾®è¯¾ä¸æ•™å­¦è¾…åŠ©èµ›é“ Demo</p>
            <p>æœ¬é¡µé¢ä»…ç”¨äºå­¦ä¹ æ¼”ç¤º | äº¤äº’å¼é—ä¼ å­¦æ•™å­¦å·¥å…·</p>
        </footer>
    </div>

    <script>
    // ========== äº¤äº’å¼é—ä¼ å›¾è°±ä»£ç  ==========
    document.addEventListener('DOMContentLoaded', function() {
        const chartDom = document.getElementById('familyTree');
        if (!chartDom) return;

        const myChart = echarts.init(chartDom);

        // 1. æ¨¡æ‹Ÿä¸€ä¸ªå®¶åº­çš„é—ä¼ æ•°æ®
        const familyData = [
            { id: 'grandpa', name: 'ç¥–çˆ¶', gender: 'male', genotype: 'AA', description: 'å¥åº·ï¼Œéæºå¸¦è€…' },
            { id: 'grandma', name: 'ç¥–æ¯', gender: 'female', genotype: 'Aa', description: 'å¥åº·ï¼Œæºå¸¦è€…' },
            { id: 'father', name: 'çˆ¶äº²', gender: 'male', genotype: 'Aa', description: 'å¥åº·ï¼Œæºå¸¦è€…' },
            { id: 'mother', name: 'æ¯äº²', gender: 'female', genotype: 'Aa', description: 'å¥åº·ï¼Œæºå¸¦è€…' },
            { id: 'child', name: 'å­©å­', gender: 'male', genotype: 'aa', description: 'æ‚£ç—…ï¼ˆå¦‚ç™½åŒ–ç—…ï¼‰' }
        ];

        // 2. å®šä¹‰å®¶åº­æˆå‘˜å…³ç³»ï¼ˆè¿çº¿ï¼‰
        const links = [
            { source: 'grandpa', target: 'father' },
            { source: 'grandma', target: 'father' },
            { source: 'grandpa', target: 'mother' },
            { source: 'grandma', target: 'mother' },
            { source: 'father', target: 'child' },
            { source: 'mother', target: 'child' }
        ];

        // 3. å°†æ•°æ®è½¬æ¢ä¸ºEChartsèŠ‚ç‚¹æ ¼å¼ï¼Œå¹¶æ ¹æ®åŸºå› å‹è®¾ç½®é¢œè‰²å’Œå¤§å°
        const nodes = familyData.map(person => {
            let nodeStyle = { 
                color: '#10B981',
                borderColor: '#0da271',
                borderWidth: 2
            };
            let symbolSize = 50;

            if (person.genotype === 'Aa') {
                nodeStyle.color = '#F59E0B';
                nodeStyle.borderColor = '#d97706';
                symbolSize = 55;
            } else if (person.genotype === 'aa') {
                nodeStyle.color = '#EF4444';
                nodeStyle.borderColor = '#dc2626';
                symbolSize = 60;
            }

            return {
                id: person.id,
                name: `${person.name}\n(${person.genotype})`,
                symbolSize: symbolSize,
                itemStyle: nodeStyle,
                label: {
                    color: '#fff',
                    fontWeight: 'bold',
                    fontSize: 14
                },
                personData: person
            };
        });

        // 4. EChartsé…ç½®é¡¹
        const option = {
            title: {
                text: 'æºå¸¦è€…çˆ¶æ¯ (Aa Ã— Aa) çš„å®¶åº­é—ä¼ ç³»è°±',
                subtext: 'ç‚¹å‡»ä»»ä¸€æˆå‘˜æŸ¥çœ‹é—ä¼ ä¿¡æ¯',
                left: 'center',
                textStyle: { 
                    fontSize: 16,
                    color: '#4F46E5'
                },
                subtextStyle: {
                    fontSize: 13,
                    color: '#6b7280'
                }
            },
            tooltip: {
                backgroundColor: 'rgba(255, 255, 255, 0.95)',
                borderColor: '#4F46E5',
                borderWidth: 1,
                textStyle: { color: '#333' },
                formatter: function(params) {
                    const p = params.data.personData;
                    return `
                    <div style="padding: 5px;">
                        <strong style="color: #4F46E5;">${p.name}</strong><br/>
                        åŸºå› å‹ï¼š<strong>${p.genotype}</strong><br/>
                        çŠ¶æ€ï¼š${p.description}
                    </div>`;
                }
            },
            series: [{
                type: 'graph',
                layout: 'force',
                data: nodes,
                links: links,
                roam: true,
                label: {
                    show: true,
                    position: 'inside',
                    formatter: '{b}',
                    color: '#fff',
                    fontWeight: 'bold',
                    fontSize: 12
                },
                lineStyle: {
                    width: 3,
                    color: '#9ca3af',
                    curveness: 0.2
                },
                force: {
                    repulsion: 250,
                    edgeLength: 120,
                    gravity: 0.1
                },
                emphasis: {
                    focus: 'adjacency',
                    lineStyle: {
                        width: 4,
                        color: '#4F46E5'
                    },
                    itemStyle: {
                        shadowBlur: 10,
                        shadowColor: 'rgba(0, 0, 0, 0.3)'
                    }
                }
            }]
        };

        // 5. åº”ç”¨é…ç½®å¹¶ç»˜åˆ¶å›¾è¡¨
        myChart.setOption(option);

        // 6. ç›‘å¬å›¾è¡¨ç‚¹å‡»äº‹ä»¶ï¼Œæ›´æ–°ä¸‹æ–¹ä¿¡æ¯æ¡†
        myChart.on('click', function(params) {
            if (params.dataType === 'node') {
                const p = params.data.personData;
                document.getElementById('selectedName').textContent = p.name;
                document.getElementById('selectedGenotype').textContent = p.genotype;
                document.getElementById('selectedDesc').textContent = p.description;
                
                // é«˜äº®æ˜¾ç¤ºå½“å‰é€‰ä¸­çš„èŠ‚ç‚¹
                myChart.dispatchAction({
                    type: 'highlight',
                    seriesIndex: 0,
                    dataIndex: params.dataIndex
                });
            }
        });

        // 7. å“åº”æµè§ˆå™¨çª—å£å¤§å°å˜åŒ–
        window.addEventListener('resize', function() {
            myChart.resize();
        });
        
        // 8. åˆå§‹åŒ–CozeèŠå¤©æœºå™¨äºº
        initCozeChat();
    });

    // ========== CozeèŠå¤©æœºå™¨äººåµŒå…¥ä»£ç  ==========
    function initCozeChat() {
        // æ³¨æ„ï¼šè¯·å°†ä¸‹é¢çš„ pat_******** æ›¿æ¢ä¸ºæ‚¨çš„å®é™…è®¿é—®ä»¤ç‰Œ
        const BOT_ID = '7599549366093430836';
        const TOKEN = 'pat_jyaGfOAQIdLZ4g1A5bNTKUckEWQhtbAYciUjFS9dLPy1z2k6HupE5m7gqyTagJlo'; // è¯·æ›¿æ¢ä¸ºæ‚¨çš„å®é™…token
        
        try {
            // åˆ›å»ºä¸€ä¸ªiframeæ¥åµŒå…¥CozeèŠå¤©
            const container = document.querySelector('.coze-chat-container');
            const placeholder = document.getElementById('chatPlaceholder');
            
            // åˆ›å»ºiframe
            const iframe = document.createElement('iframe');
            iframe.id = 'coze-chat-iframe';
            iframe.style.width = '100%';
            iframe.style.height = '100%';
            iframe.style.border = 'none';
            
            // æ„å»ºCozeèŠå¤©URL
            const chatUrl = `https://www.coze.cn/embed/${BOT_ID}`;
            
            // è®¾ç½®iframeçš„src
            iframe.src = chatUrl;
            
            // æ·»åŠ iframeåˆ°å®¹å™¨
            container.appendChild(iframe);
            
            // å½“iframeåŠ è½½å®Œæˆåéšè—å ä½ç¬¦
            iframe.onload = function() {
                placeholder.style.display = 'none';
                console.log('CozeèŠå¤©æœºå™¨äººå·²åŠ è½½');
            };
            
            iframe.onerror = function(error) {
                console.error('CozeèŠå¤©æœºå™¨äººåŠ è½½å¤±è´¥:', error);
                placeholder.innerHTML = `
                    <h3 style="color: #EF4444;">åŠ è½½å¤±è´¥</h3>
                    <p>AIå¯¼å¸ˆæš‚æ—¶æ— æ³•è¿æ¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œæˆ–åˆ·æ–°é¡µé¢é‡è¯•</p>
                    <p style="font-size: 0.85rem; color: #666;">è¯·ç¡®ä¿tokenå·²æ­£ç¡®é…ç½®</p>
                    <button onclick="location.reload()" style="margin-top: 15px; padding: 8px 16px; background: #4F46E5; color: white; border: none; border-radius: 6px; cursor: pointer;">
                        é‡æ–°åŠ è½½
                    </button>
                `;
            };
            
        } catch (error) {
            console.error('åˆå§‹åŒ–CozeèŠå¤©æœºå™¨äººæ—¶å‡ºé”™:', error);
            const placeholder = document.getElementById('chatPlaceholder');
            placeholder.innerHTML = `
                <h3 style="color: #EF4444;">åˆå§‹åŒ–é”™è¯¯</h3>
                <p>æ— æ³•åŠ è½½AIå¯¼å¸ˆï¼Œè¯·æ£€æŸ¥é…ç½®æˆ–åˆ·æ–°é¡µé¢</p>
                <p style="font-size: 0.85rem; color: #666;">é”™è¯¯ä¿¡æ¯: ${error.message}</p>
            `;
        }
    }
    
    // ç®€å•çš„æœ¬åœ°äº’åŠ¨å‡½æ•°
    function showAnswer(buttonElement) {
        const answerEl = buttonElement.nextElementSibling;
        answerEl.style.display = answerEl.style.display === 'block' ? 'none' : 'block';
        buttonElement.textContent = answerEl.style.display === 'block' ? 'æ”¶èµ·è§£æ' : 'ç‚¹å‡»æŸ¥çœ‹ç­”æ¡ˆä¸è§£æ';
    }
    </script>
</body>
</html>